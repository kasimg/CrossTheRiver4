{"version":3,"sources":["../../../../assets/Script/assets/Script/GoBtn.js"],"names":["cc","Class","extends","Component","properties","initTimeConsumingSum","timeConsumingSum","moveAnimalsAndLantern","bridgeCom","mainScriptCom","bridgeNode","getComponent","passages","getPassages","lanternCom","lanternNode","timeConsuming","getTimeConsuming","forEach","passage","setTimeConsuming","node","runAction","sequence","crossRiver","callFunc","toggleBridgePosInfo","move","updateTimeConsuming","onMouseDown","isEmpty","bindMouseDownEvent","on","Node","EventType","MOUSE_DOWN","showTime","timeDisplayer","crossTimeConsumingDisplayer","length","string","appearTween","tween","to","opacity","start","hideTime","console","log","timer","onMouseLeave","onMouseEnter","bindMouseEnterEvent","MOUSE_ENTER","bindMouseLeaveEvent","MOUSE_LEAVE","onLoad"],"mappings":"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","file":"GoBtn.js","sourceRoot":"../../../../assets/Script","sourcesContent":["import { bindCursorEvent, bindScaleEvent } from './Utils';\n//  go按钮对象\ncc.Class({\n  extends: cc.Component,\n\n  properties: {\n  },\n\n  //  初始化总消耗的时间\n  initTimeConsumingSum() {\n    this.timeConsumingSum = 0;\n  },\n\n  //  移动动物和灯笼\n  moveAnimalsAndLantern() {\n    // const bridgeNode = this.mainScriptCom.bridgeNode;\n    const bridgeCom = this.mainScriptCom.bridgeNode.getComponent('Bridge');\n    const passages = bridgeCom.getPassages();\n    // const lanternNode = this.mainScriptCom.lanternNode;\n    const lanternCom = this.mainScriptCom.lanternNode.getComponent('Lantern');\n    // const \n\n    //  获取移动时间\n    const timeConsuming = bridgeCom.getTimeConsuming();\n\n    //  乘客移动\n    passages.forEach((passage) => {\n      passage.setTimeConsuming(timeConsuming);\n      passage.node.runAction(cc.sequence(passage.crossRiver(), cc.callFunc(() => {\n        passage.toggleBridgePosInfo();\n        // this.updateTimeConsuming();\n      })));\n    });\n\n    //  灯笼移动\n    lanternCom.setTimeConsuming(timeConsuming);\n    lanternCom.node.runAction(cc.sequence(lanternCom.move(), cc.callFunc(() => {\n      lanternCom.toggleBridgePosInfo();\n      this.updateTimeConsuming();\n    })))\n    // lanternCom.move();\n  },\n\n  //  按钮点击事件\n  onMouseDown() {\n    const bridgeCom = this.mainScriptCom.bridgeNode.getComponent('Bridge');\n    if (!bridgeCom.isEmpty()) {\n      this.moveAnimalsAndLantern();\n    }\n  },\n\n  //  绑定按钮点击事件\n  bindMouseDownEvent() {\n    this.node.on(cc.Node.EventType.MOUSE_DOWN, this.onMouseDown, this);\n  },\n\n  //  显示此次过河需要的时间\n  showTime() {\n    const bridgeCom = this.mainScriptCom.bridgeNode.getComponent('Bridge');\n    const timeDisplayer = this.mainScriptCom.crossTimeConsumingDisplayer;\n    if (bridgeCom.getPassages().length > 0) {  //  如果有乘客才显示过河需要花费的时间\n      const timeConsuming = bridgeCom.getTimeConsuming();\n      //  缓慢浮现时间\n      timeDisplayer.string = '此次过河需要' + timeConsuming + '秒';\n      const appearTween = cc.tween(timeDisplayer.node)\n        .to(0.3, { opacity: 255 });\n      appearTween.start();\n    }\n  },\n\n  //  取消过河时间的显示\n  hideTime() {\n    const timeDisplayer = this.mainScriptCom.crossTimeConsumingDisplayer;\n    cc.tween(timeDisplayer.node)\n      .to(0.3, { opacity: 0 })\n      .start();\n  },\n\n  //  更新总耗时的显示\n  updateTimeConsuming() {\n    console.log('update')\n    const timer = this.mainScriptCom.timer;\n    const bridgeCom = this.mainScriptCom.bridgeNode.getComponent('Bridge');\n    this.timeConsumingSum += bridgeCom.getTimeConsuming();\n    timer.string = '总耗时: ' + this.timeConsumingSum + '秒';\n  },\n\n  //  鼠标离开事件\n  onMouseLeave() {\n    this.hideTime();\n  },\n\n  //  鼠标悬停事件\n  onMouseEnter() {\n    this.showTime();\n  },\n\n  //  绑定鼠标悬停事件\n  bindMouseEnterEvent() {\n    this.node.on(cc.Node.EventType.MOUSE_ENTER, this.onMouseEnter, this);\n  },\n\n  //  绑定鼠标离开事件\n  bindMouseLeaveEvent() {\n    this.node.on(cc.Node.EventType.MOUSE_LEAVE, this.onMouseLeave, this);\n  },\n\n  onLoad() {\n    this.initTimeConsumingSum();\n    this.bindMouseDownEvent();\n    this.bindMouseEnterEvent();\n    this.bindMouseLeaveEvent();\n    bindCursorEvent(this.node, this);\n    bindScaleEvent(this.node, this, 0.21 , 0.19);\n    // this.updateTimeConsuming();\n    // this.node.on(cc.Node.EventType.MOUSE_ENTER, () => {console.log('a')}, this);\n    // this.node.on(cc.Node.EventType.MOUSE_ENTER, () => {console.log('b')}, this);\n  },\n\n  start() {\n\n  },\n\n  // update (dt) {},\n});\n"]}