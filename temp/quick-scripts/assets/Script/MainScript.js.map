{"version":3,"sources":["MainScript.js"],"names":["cc","Class","extends","Component","properties","data","default","type","JsonAsset","animalPrefabNode","Prefab","animalComs","lanternNode","Node","bridgeNode","goBtnNode","AnimalTimeConsumingDisplayer","Label","crossTimeConsumingDisplayer","timer","createAnimalNodes","json","animals","forEach","animal","animalNode","instantiate","animalCom","getComponent","Object","keys","pro","loader","loadRes","name","SpriteFrame","err","spriteFrame","Sprite","mainScriptCom","setPosition","leftPos","x","y","push","node","addChild","initLanternNode","lantern","initGoBtnNode","ifSucceed","filter","posInfo","RIGHT_RIVER_BANK","length","succeed","director","loadScene","onLoad","start"],"mappings":"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","file":"MainScript.js","sourceRoot":"../../../../assets/Script","sourcesContent":["cc.Class({\n  extends: cc.Component,\n\n  properties: {\n    data: {\n      default: null,\n      type: cc.JsonAsset,\n    },\n    animalPrefabNode: {\n      default: null,\n      type: cc.Prefab,\n    },\n    animalComs: [cc.Component],  //  存放所有动物实例\n    lanternNode: {  //  存放灯节点\n      default: null,\n      type: cc.Node,\n    },\n    bridgeNode: {\n      default: null,\n      type: cc.Node,\n    },\n    goBtnNode: {\n      default: null,\n      type: cc.Node,\n    },\n    AnimalTimeConsumingDisplayer: {\n      default: null,\n      type: cc.Label,\n    },\n    crossTimeConsumingDisplayer: {\n      default: null,\n      type: cc.Label,\n    },\n    timer: {  //  显示一共消耗的时间\n      default: null,\n      type: cc.Label,\n    },\n  },\n\n  //  创建动物节点\n  createAnimalNodes() {\n    this.data.json.animals.forEach((animal) => {\n      const animalNode = cc.instantiate(this.animalPrefabNode);\n      const animalCom = animalNode.getComponent('Animal');\n      Object.keys(animal).forEach((pro) => {\n        // console.log(index);\n        animalCom[pro] = animal[pro];\n      });\n\n      //  加载图像资源\n      cc.loader.loadRes(animalCom.name, cc.SpriteFrame, (err, spriteFrame) => {\n        // console.log(err, spriteFrame);\n        animalNode.getComponent(cc.Sprite).spriteFrame = spriteFrame;\n      });\n\n      animalCom.mainScriptCom = this;\n      animalNode.setPosition(animalCom.leftPos.x, animalCom.leftPos.y);\n      this.animalComs.push(animalCom);\n      this.node.addChild(animalNode);\n      // console.log(animalCom); \n    });\n  },\n\n  //  初始化灯笼节点\n  initLanternNode() {\n    this.lanternNode.setPosition(this.data.json.lantern.leftPos.x, this.data.json.lantern.leftPos.y);\n  },\n\n  //  初始化GO按钮节点\n  initGoBtnNode() {\n    this.goBtnNode.getComponent('GoBtn').mainScriptCom = this;\n  },\n\n  //  判断是否所有动物都在右岸\n  ifSucceed() {\n    if (this.animalComs.filter((animal) => {\n      // this.data.json.posInfo.RIGHT_RIVER_BANK\n      return animal.posInfo === this.data.json.posInfo.RIGHT_RIVER_BANK\n    }).length === this.animalComs.length) return true;\n    return false;\n  },\n\n  //  游戏胜利的回调函数\n  succeed() {\n    cc.director.loadScene('succeed');\n  },\n\n  onLoad () {\n    // console.log(this.data);\n    this.createAnimalNodes();\n    this.initLanternNode();\n    this.initGoBtnNode();\n  },\n\n  start() {\n\n  },\n\n  // update (dt) {},\n});\n"]}